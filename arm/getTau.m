function Tau=getTau(y,Xref, model)
theta1 = y(1);
theta2 = y(2);
theta1d = y(3);
theta2d = y(4);
xr = Xref(1);
yr = Xref(2);
xrd = Xref(3);
yrd = Xref(4);
xrdd=Xref(5);
yrdd=Xref(6);

g=0;
l=model.l;
m1=model.m2;
m2=model.m2;
xc=model.xc;
yc=model.yc;
r0=model.r-0.1;
X = [l*cos(theta1) + l*cos(theta1+theta2); l*sin(theta1)+ l*sin(theta1+theta2)];
xact=X(1);
yact=X(2);
alpha=atan2(yact-yc, xact-xc);
deltar=norm([xc+r0*cos(alpha);yc+r0*sin(alpha)]-[xact;yact]);
Fdes=10*deltar*[cos(alpha);sin(alpha)];
J = [-l*sin(theta1), -l*sin(theta1+theta2); l*cos(theta1) + l*cos(theta1+theta2), l*cos(theta1+theta2)];
Tauextra=-J.'*Fdes;
% X = [l*cos(theta1) + l*cos(theta1+theta2); l*sin(theta1)+ l*sin(theta1+theta2)];
% J = [-l*sin(theta1), -l*sin(theta1+theta2); l*cos(theta1) + l*cos(theta1+theta2), l*cos(theta1+theta2)];
% x = X(1);
% y = X(2);
% Xd = J*[theta1d;theta2d];
% xd=Xd(1);
% yd=Xd(2);
epsilon(1,1)=[((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*(yr+(-1).*l.*sin( ...
  theta1)+(-1).*l.*sin(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos( ...
  theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2) ...
  .^(-1/2)+(-1).*(xr+(-1).*l.*cos(theta1)+(-1).*l.*cos(theta1+theta2)).*(( ...
  -1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).*(((-1).*xc+l.*cos(theta1) ...
  +l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+ ...
  theta2)).^2).^(-1/2)];
epsilon(2,1)=[(-1).*(xr+(-1).*l.*cos(theta1)+(-1).*l.*cos(theta1+theta2)).*((-1).*xc+ ...
  l.*cos(theta1)+l.*cos(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos( ...
  theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2) ...
  .^(-1/2)+(-1).*(yr+(-1).*l.*sin(theta1)+(-1).*l.*sin(theta1+theta2)).*(( ...
  -1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).*(((-1).*xc+l.*cos(theta1) ...
  +l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+ ...
  theta2)).^2).^(-1/2)];
epsilond(1,1)=[((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*(yrd+(-1).*l.* ...
  theta1d.*cos(theta1)+(-1).*l.*(theta1d+theta2d).*cos(theta1+theta2)).*(( ...
  (-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin( ...
  theta1)+l.*sin(theta1+theta2)).^2).^(-1/2)+(-1).*(xr+(-1).*l.*cos( ...
  theta1)+(-1).*l.*cos(theta1+theta2)).*(l.*theta1d.*cos(theta1)+l.*( ...
  theta1d+theta2d).*cos(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos( ...
  theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2) ...
  .^(-1/2)+(yr+(-1).*l.*sin(theta1)+(-1).*l.*sin(theta1+theta2)).*((-1).* ...
  l.*theta1d.*sin(theta1)+(-1).*l.*(theta1d+theta2d).*sin(theta1+theta2)) ...
  .*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin( ...
  theta1)+l.*sin(theta1+theta2)).^2).^(-1/2)+(-1).*((-1).*yc+l.*sin( ...
  theta1)+l.*sin(theta1+theta2)).*(xrd+l.*theta1d.*sin(theta1)+l.*( ...
  theta1d+theta2d).*sin(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos( ...
  theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2) ...
  .^(-1/2)+(-1/2).*((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*(yr+( ...
  -1).*l.*sin(theta1)+(-1).*l.*sin(theta1+theta2)).*(((-1).*xc+l.*cos( ...
  theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin( ...
  theta1+theta2)).^2).^(-3/2).*(2.*(l.*theta1d.*cos(theta1)+l.*(theta1d+ ...
  theta2d).*cos(theta1+theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin(theta1+ ...
  theta2))+2.*((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*((-1).*l.* ...
  theta1d.*sin(theta1)+(-1).*l.*(theta1d+theta2d).*sin(theta1+theta2)))+( ...
  1/2).*(xr+(-1).*l.*cos(theta1)+(-1).*l.*cos(theta1+theta2)).*((-1).*yc+ ...
  l.*sin(theta1)+l.*sin(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos( ...
  theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2) ...
  .^(-3/2).*(2.*(l.*theta1d.*cos(theta1)+l.*(theta1d+theta2d).*cos(theta1+ ...
  theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2))+2.*((-1).*xc+ ...
  l.*cos(theta1)+l.*cos(theta1+theta2)).*((-1).*l.*theta1d.*sin(theta1)+( ...
  -1).*l.*(theta1d+theta2d).*sin(theta1+theta2)))];
epsilond(2,1)=[(-1).*(l.*theta1d.*cos(theta1)+l.*(theta1d+theta2d).*cos(theta1+theta2) ...
  ).*(yr+(-1).*l.*sin(theta1)+(-1).*l.*sin(theta1+theta2)).*(((-1).*xc+l.* ...
  cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin( ...
  theta1+theta2)).^2).^(-1/2)+(-1).*(yrd+(-1).*l.*theta1d.*cos(theta1)+( ...
  -1).*l.*(theta1d+theta2d).*cos(theta1+theta2)).*((-1).*yc+l.*sin(theta1) ...
  +l.*sin(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2) ...
  ).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2).^(-1/2)+(-1).*( ...
  xr+(-1).*l.*cos(theta1)+(-1).*l.*cos(theta1+theta2)).*((-1).*l.* ...
  theta1d.*sin(theta1)+(-1).*l.*(theta1d+theta2d).*sin(theta1+theta2)).*(( ...
  (-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin( ...
  theta1)+l.*sin(theta1+theta2)).^2).^(-1/2)+(-1).*((-1).*xc+l.*cos( ...
  theta1)+l.*cos(theta1+theta2)).*(xrd+l.*theta1d.*sin(theta1)+l.*( ...
  theta1d+theta2d).*sin(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos( ...
  theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2) ...
  .^(-1/2)+(1/2).*(xr+(-1).*l.*cos(theta1)+(-1).*l.*cos(theta1+theta2)).*( ...
  (-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*(((-1).*xc+l.*cos( ...
  theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin( ...
  theta1+theta2)).^2).^(-3/2).*(2.*(l.*theta1d.*cos(theta1)+l.*(theta1d+ ...
  theta2d).*cos(theta1+theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin(theta1+ ...
  theta2))+2.*((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*((-1).*l.* ...
  theta1d.*sin(theta1)+(-1).*l.*(theta1d+theta2d).*sin(theta1+theta2)))+( ...
  1/2).*(yr+(-1).*l.*sin(theta1)+(-1).*l.*sin(theta1+theta2)).*((-1).*yc+ ...
  l.*sin(theta1)+l.*sin(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos( ...
  theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2) ...
  .^(-3/2).*(2.*(l.*theta1d.*cos(theta1)+l.*(theta1d+theta2d).*cos(theta1+ ...
  theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2))+2.*((-1).*xc+ ...
  l.*cos(theta1)+l.*cos(theta1+theta2)).*((-1).*l.*theta1d.*sin(theta1)+( ...
  -1).*l.*(theta1d+theta2d).*sin(theta1+theta2)))];
coeffmat(1,1)=((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*((-1/3).*l.^3.*m2.*cos( ...
  theta1).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1)+(-1).*l.*((1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+( ...
  1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((-1/3).* ...
  l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*cos(theta1+ ...
  theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+ ...
  l.*sin(theta1)+l.*sin(theta1+theta2)).^2).^(-1/2)+((-1).*xr+l.*cos( ...
  theta1)+l.*cos(theta1+theta2)).*((1/3).*l.^3.*m2.*cos(theta1).*((1/9).* ...
  l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^( ...
  -1)+l.*((1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4) ...
  .*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((-1/3).*l.^2.*m2+(-1/2).*l.^2.* ...
  m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1)).*cos(theta1+theta2)).*(((-1).*xc+l.*cos( ...
  theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin( ...
  theta1+theta2)).^2).^(-1/2)+(yr+(-1).*l.*sin(theta1)+(-1).*l.*sin( ...
  theta1+theta2)).*((-1/3).*l.^3.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.* ...
  m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*sin(theta1)+(-1).*l.*( ...
  (1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1)+((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos( ...
  theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1)).*sin(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+ ...
  l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2) ...
  ).^2).^(-1/2)+(yc+(-1).*l.*sin(theta1)+(-1).*l.*sin(theta1+theta2)).*(( ...
  1/3).*l.^3.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1).*sin(theta1)+l.*((1/3).*l.^2.*m2.*((1/9).* ...
  l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^( ...
  -1)+((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.* ...
  m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*sin( ...
  theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+(( ...
  -1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2).^(-1/2)+(1/2).*(xc+( ...
  -1).*l.*cos(theta1)+(-1).*l.*cos(theta1+theta2)).*(yr+(-1).*l.*sin( ...
  theta1)+(-1).*l.*sin(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos( ...
  theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2) ...
  .^(-3/2).*(2.*((1/3).*l.^3.*m2.*cos(theta1).*((1/9).*l.^4.*m1.*m2+(1/3) ...
  .*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+l.*((1/3).* ...
  l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1)+((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).* ...
  ((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1)).*cos(theta1+theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin( ...
  theta1+theta2))+2.*((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*(( ...
  -1/3).*l.^3.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1).*sin(theta1)+(-1).*l.*((1/3).*l.^2.*m2.*(( ...
  1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1)+((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).* ...
  l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^( ...
  -1)).*sin(theta1+theta2)))+(1/2).*(xr+(-1).*l.*cos(theta1)+(-1).*l.*cos( ...
  theta1+theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).*(((-1) ...
  .*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+ ...
  l.*sin(theta1+theta2)).^2).^(-3/2).*(2.*((1/3).*l.^3.*m2.*cos(theta1).*( ...
  (1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1)+l.*((1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+ ...
  (-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((-1/3).*l.^2.*m2+(-1/2).* ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*cos(theta1+theta2)).*((-1).*yc+l.* ...
  sin(theta1)+l.*sin(theta1+theta2))+2.*((-1).*xc+l.*cos(theta1)+l.*cos( ...
  theta1+theta2)).*((-1/3).*l.^3.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.* ...
  m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*sin(theta1)+(-1).*l.*( ...
  (1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1)+((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos( ...
  theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1)).*sin(theta1+theta2)));
coeffmat(2,1)=((-1/3).*l.^3.*m2.*cos(theta1).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+ ...
  (-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+(-1).*l.*((1/3).*l.^2.*m2.*(( ...
  1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1)+((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).* ...
  l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^( ...
  -1)).*cos(theta1+theta2)).*(yc+(-1).*l.*sin(theta1)+(-1).*l.*sin(theta1+ ...
  theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+ ...
  l.*sin(theta1)+l.*sin(theta1+theta2)).^2).^(-1/2)+((1/3).*l.^3.*m2.*cos( ...
  theta1).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1)+l.*((1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((-1/3).*l.^2.* ...
  m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.* ...
  m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*cos(theta1+theta2)).* ...
  ((-1).*yr+l.*sin(theta1)+l.*sin(theta1+theta2)).*(((-1).*xc+l.*cos( ...
  theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin( ...
  theta1+theta2)).^2).^(-1/2)+((-1).*xr+l.*cos(theta1)+l.*cos(theta1+ ...
  theta2)).*((-1/3).*l.^3.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+( ...
  -1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*sin(theta1)+(-1).*l.*((1/3).* ...
  l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1)+((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).* ...
  ((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1)).*sin(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos( ...
  theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2) ...
  .^(-1/2)+(xc+(-1).*l.*cos(theta1)+(-1).*l.*cos(theta1+theta2)).*((1/3).* ...
  l.^3.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1).*sin(theta1)+l.*((1/3).*l.^2.*m2.*((1/9).*l.^4.* ...
  m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+(( ...
  -1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+( ...
  1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*sin( ...
  theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+(( ...
  -1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2).^(-1/2)+(1/2).*(xr+( ...
  -1).*l.*cos(theta1)+(-1).*l.*cos(theta1+theta2)).*((-1).*xc+l.*cos( ...
  theta1)+l.*cos(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+ ...
  theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2).^(-3/2) ...
  .*(2.*((1/3).*l.^3.*m2.*cos(theta1).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.* ...
  m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+l.*((1/3).*l.^2.*m2.*(( ...
  1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1)+((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).* ...
  l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^( ...
  -1)).*cos(theta1+theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin(theta1+ ...
  theta2))+2.*((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*((-1/3).* ...
  l.^3.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1).*sin(theta1)+(-1).*l.*((1/3).*l.^2.*m2.*((1/9).* ...
  l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^( ...
  -1)+((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.* ...
  m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*sin( ...
  theta1+theta2)))+(1/2).*(yr+(-1).*l.*sin(theta1)+(-1).*l.*sin(theta1+ ...
  theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).*(((-1).*xc+ ...
  l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.* ...
  sin(theta1+theta2)).^2).^(-3/2).*(2.*((1/3).*l.^3.*m2.*cos(theta1).*(( ...
  1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1)+l.*((1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+ ...
  (-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((-1/3).*l.^2.*m2+(-1/2).* ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*cos(theta1+theta2)).*((-1).*yc+l.* ...
  sin(theta1)+l.*sin(theta1+theta2))+2.*((-1).*xc+l.*cos(theta1)+l.*cos( ...
  theta1+theta2)).*((-1/3).*l.^3.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.* ...
  m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*sin(theta1)+(-1).*l.*( ...
  (1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1)+((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos( ...
  theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1)).*sin(theta1+theta2)));
coeffmat(1,2)=((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*((-1).*l.*cos(theta1).* ...
  ((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+( ...
  1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+(-1).*l.*(( ...
  (-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+( ...
  1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((1/3).* ...
  l.^2.*m1+(4/3).*l.^2.*m2+l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+( ...
  1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*cos( ...
  theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+(( ...
  -1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2).^(-1/2)+((-1).*xr+l.* ...
  cos(theta1)+l.*cos(theta1+theta2)).*(l.*cos(theta1).*((-1/3).*l.^2.*m2+( ...
  -1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+( ...
  -1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+l.*(((-1/3).*l.^2.*m2+(-1/2).* ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((1/3).*l.^2.*m1+(4/3).*l.^2.*m2+ ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*cos(theta1+theta2)).*(((-1).*xc+l.* ...
  cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin( ...
  theta1+theta2)).^2).^(-1/2)+(yr+(-1).*l.*sin(theta1)+(-1).*l.*sin( ...
  theta1+theta2)).*((-1).*l.*((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos( ...
  theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1).*sin(theta1)+(-1).*l.*(((-1/3).*l.^2.*m2+(-1/2).* ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((1/3).*l.^2.*m1+(4/3).*l.^2.*m2+ ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*sin(theta1+theta2)).*(((-1).*xc+l.* ...
  cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin( ...
  theta1+theta2)).^2).^(-1/2)+(yc+(-1).*l.*sin(theta1)+(-1).*l.*sin( ...
  theta1+theta2)).*(l.*((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*( ...
  (1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1).*sin(theta1)+l.*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos( ...
  theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1)+((1/3).*l.^2.*m1+(4/3).*l.^2.*m2+l.^2.*m2.*cos( ...
  theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1)).*sin(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+ ...
  l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2) ...
  ).^2).^(-1/2)+(1/2).*(xc+(-1).*l.*cos(theta1)+(-1).*l.*cos(theta1+ ...
  theta2)).*(yr+(-1).*l.*sin(theta1)+(-1).*l.*sin(theta1+theta2)).*(((-1) ...
  .*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+ ...
  l.*sin(theta1+theta2)).^2).^(-3/2).*(2.*(l.*cos(theta1).*((-1/3).*l.^2.* ...
  m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.* ...
  m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+l.*(((-1/3).*l.^2.*m2+( ...
  -1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+( ...
  -1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((1/3).*l.^2.*m1+(4/3).*l.^2.* ...
  m2+l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+( ...
  -1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*cos(theta1+theta2)).*((-1).* ...
  yc+l.*sin(theta1)+l.*sin(theta1+theta2))+2.*((-1).*xc+l.*cos(theta1)+l.* ...
  cos(theta1+theta2)).*((-1).*l.*((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos( ...
  theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1).*sin(theta1)+(-1).*l.*(((-1/3).*l.^2.*m2+(-1/2).* ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((1/3).*l.^2.*m1+(4/3).*l.^2.*m2+ ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*sin(theta1+theta2)))+(1/2).*(xr+( ...
  -1).*l.*cos(theta1)+(-1).*l.*cos(theta1+theta2)).*((-1).*yc+l.*sin( ...
  theta1)+l.*sin(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+ ...
  theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2).^(-3/2) ...
  .*(2.*(l.*cos(theta1).*((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)) ...
  .*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos( ...
  theta2).^2).^(-1)+l.*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).* ...
  ((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1)+((1/3).*l.^2.*m1+(4/3).*l.^2.*m2+l.^2.*m2.*cos(theta2)).*(( ...
  1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1)).*cos(theta1+theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin( ...
  theta1+theta2))+2.*((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*(( ...
  -1).*l.*((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.* ...
  m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).* ...
  sin(theta1)+(-1).*l.*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).* ...
  ((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1)+((1/3).*l.^2.*m1+(4/3).*l.^2.*m2+l.^2.*m2.*cos(theta2)).*(( ...
  1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1)).*sin(theta1+theta2)));
coeffmat(2,2)=((-1).*l.*cos(theta1).*((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)) ...
  .*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos( ...
  theta2).^2).^(-1)+(-1).*l.*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos( ...
  theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1)+((1/3).*l.^2.*m1+(4/3).*l.^2.*m2+l.^2.*m2.*cos( ...
  theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1)).*cos(theta1+theta2)).*(yc+(-1).*l.*sin(theta1)+( ...
  -1).*l.*sin(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+ ...
  theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2).^(-1/2)+ ...
  (l.*cos(theta1).*((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*(( ...
  1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1)+l.*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9) ...
  .*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2) ...
  .^(-1)+((1/3).*l.^2.*m1+(4/3).*l.^2.*m2+l.^2.*m2.*cos(theta2)).*((1/9).* ...
  l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^( ...
  -1)).*cos(theta1+theta2)).*((-1).*yr+l.*sin(theta1)+l.*sin(theta1+ ...
  theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+ ...
  l.*sin(theta1)+l.*sin(theta1+theta2)).^2).^(-1/2)+((-1).*xr+l.*cos( ...
  theta1)+l.*cos(theta1+theta2)).*((-1).*l.*((-1/3).*l.^2.*m2+(-1/2).* ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1).*sin(theta1)+(-1).*l.*(((-1/3).* ...
  l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((1/3).*l.^2.*m1+ ...
  (4/3).*l.^2.*m2+l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*sin(theta1+ ...
  theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+ ...
  l.*sin(theta1)+l.*sin(theta1+theta2)).^2).^(-1/2)+(xc+(-1).*l.*cos( ...
  theta1)+(-1).*l.*cos(theta1+theta2)).*(l.*((-1/3).*l.^2.*m2+(-1/2).* ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1).*sin(theta1)+l.*(((-1/3).*l.^2.*m2+( ...
  -1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+( ...
  -1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((1/3).*l.^2.*m1+(4/3).*l.^2.* ...
  m2+l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+( ...
  -1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*sin(theta1+theta2)).*(((-1) ...
  .*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+ ...
  l.*sin(theta1+theta2)).^2).^(-1/2)+(1/2).*(xr+(-1).*l.*cos(theta1)+(-1) ...
  .*l.*cos(theta1+theta2)).*((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2) ...
  ).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin( ...
  theta1)+l.*sin(theta1+theta2)).^2).^(-3/2).*(2.*(l.*cos(theta1).*((-1/3) ...
  .*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+l.*(((-1/3).* ...
  l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((1/3).*l.^2.*m1+ ...
  (4/3).*l.^2.*m2+l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*cos(theta1+ ...
  theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2))+2.*((-1).*xc+ ...
  l.*cos(theta1)+l.*cos(theta1+theta2)).*((-1).*l.*((-1/3).*l.^2.*m2+( ...
  -1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+( ...
  -1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*sin(theta1)+(-1).*l.*(((-1/3) ...
  .*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((1/3).*l.^2.*m1+ ...
  (4/3).*l.^2.*m2+l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*sin(theta1+ ...
  theta2)))+(1/2).*(yr+(-1).*l.*sin(theta1)+(-1).*l.*sin(theta1+theta2)).* ...
  ((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).*(((-1).*xc+l.*cos( ...
  theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin( ...
  theta1+theta2)).^2).^(-3/2).*(2.*(l.*cos(theta1).*((-1/3).*l.^2.*m2+( ...
  -1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+( ...
  -1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+l.*(((-1/3).*l.^2.*m2+(-1/2).* ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((1/3).*l.^2.*m1+(4/3).*l.^2.*m2+ ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*cos(theta1+theta2)).*((-1).*yc+l.* ...
  sin(theta1)+l.*sin(theta1+theta2))+2.*((-1).*xc+l.*cos(theta1)+l.*cos( ...
  theta1+theta2)).*((-1).*l.*((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos( ...
  theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1).*sin(theta1)+(-1).*l.*(((-1/3).*l.^2.*m2+(-1/2).* ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((1/3).*l.^2.*m1+(4/3).*l.^2.*m2+ ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*sin(theta1+theta2)));
rem(1,1)=[2.*(yrd+(-1).*l.*theta1d.*cos(theta1)+(-1).*l.*(theta1d+theta2d).*cos( ...
  theta1+theta2)).*((-1).*l.*theta1d.*sin(theta1)+(-1).*l.*(theta1d+ ...
  theta2d).*sin(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+ ...
  theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2).^(-1/2)+ ...
  (-2).*(l.*theta1d.*cos(theta1)+l.*(theta1d+theta2d).*cos(theta1+theta2)) ...
  .*(xrd+l.*theta1d.*sin(theta1)+l.*(theta1d+theta2d).*sin(theta1+theta2)) ...
  .*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin( ...
  theta1)+l.*sin(theta1+theta2)).^2).^(-1/2)+(-1).*(xr+(-1).*l.*cos( ...
  theta1)+(-1).*l.*cos(theta1+theta2)).*((-1).*l.*theta1d.^2.*sin(theta1)+ ...
  l.*cos(theta1).*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*(( ...
  1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+(-1/2).*l.^2.* ...
  m2.*theta1d.^2.*sin(theta2))+(1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3) ...
  .*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).* ...
  g.*l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+ ...
  l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.* ...
  sin(theta2)))+l.*cos(theta1+theta2).*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.* ...
  m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+theta2) ...
  +(-1/2).*l.^2.*m2.*theta1d.^2.*sin(theta2))+((1/3).*l.^2.*m1+(4/3).* ...
  l.^2.*m2+l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.* ...
  m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1/2).*g.*l.* ...
  m2.*cos(theta1+theta2)+(-1/2).*l.^2.*m2.*theta1d.^2.*sin(theta2))+(1/3) ...
  .*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.*l.*((1/2).*m1+m2).*cos( ...
  theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+l.^2.*m2.*theta1d.* ...
  theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.*sin(theta2))+((-1/3).* ...
  l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.* ...
  l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+ ...
  l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.* ...
  sin(theta2)))+(-1).*l.*(theta1d+theta2d).^2.*sin(theta1+theta2)).*(((-1) ...
  .*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+ ...
  l.*sin(theta1+theta2)).^2).^(-1/2)+((-1).*xc+l.*cos(theta1)+l.*cos( ...
  theta1+theta2)).*(yrdd+l.*theta1d.^2.*sin(theta1)+(-1).*l.*cos(theta1).* ...
  (((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+ ...
  (1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+( ...
  -1/2).*g.*l.*m2.*cos(theta1+theta2)+(-1/2).*l.^2.*m2.*theta1d.^2.*sin( ...
  theta2))+(1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4) ...
  .*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.*l.*((1/2).*m1+m2).* ...
  cos(theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+l.^2.*m2.*theta1d.* ...
  theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.*sin(theta2)))+(-1).* ...
  l.*cos(theta1+theta2).*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)) ...
  .*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos( ...
  theta2).^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+(-1/2).* ...
  l.^2.*m2.*theta1d.^2.*sin(theta2))+((1/3).*l.^2.*m1+(4/3).*l.^2.*m2+ ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+ ...
  theta2)+(-1/2).*l.^2.*m2.*theta1d.^2.*sin(theta2))+(1/3).*l.^2.*m2.*(( ...
  1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1).*(1+(-1).*g.*l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.* ...
  m2.*cos(theta1+theta2)+l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).* ...
  l.^2.*m2.*theta2d.^2.*sin(theta2))+((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.* ...
  cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.*l.*((1/2).*m1+m2).*cos( ...
  theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+l.^2.*m2.*theta1d.* ...
  theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.*sin(theta2)))+l.*( ...
  theta1d+theta2d).^2.*sin(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.* ...
  cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)) ...
  .^2).^(-1/2)+(yr+(-1).*l.*sin(theta1)+(-1).*l.*sin(theta1+theta2)).*(( ...
  -1).*l.*theta1d.^2.*cos(theta1)+(-1).*l.*(theta1d+theta2d).^2.*cos( ...
  theta1+theta2)+(-1).*l.*sin(theta1).*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.* ...
  m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+theta2) ...
  +(-1/2).*l.^2.*m2.*theta1d.^2.*sin(theta2))+(1/3).*l.^2.*m2.*((1/9).* ...
  l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^( ...
  -1).*(1+(-1).*g.*l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.*m2.* ...
  cos(theta1+theta2)+l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).*l.^2.* ...
  m2.*theta2d.^2.*sin(theta2)))+(-1).*l.*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.* ...
  m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+theta2) ...
  +(-1/2).*l.^2.*m2.*theta1d.^2.*sin(theta2))+((1/3).*l.^2.*m1+(4/3).* ...
  l.^2.*m2+l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.* ...
  m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1/2).*g.*l.* ...
  m2.*cos(theta1+theta2)+(-1/2).*l.^2.*m2.*theta1d.^2.*sin(theta2))+(1/3) ...
  .*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.*l.*((1/2).*m1+m2).*cos( ...
  theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+l.^2.*m2.*theta1d.* ...
  theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.*sin(theta2))+((-1/3).* ...
  l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.* ...
  l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+ ...
  l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.* ...
  sin(theta2))).*sin(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos( ...
  theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2) ...
  .^(-1/2)+(-1).*((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).*(xrdd+ ...
  l.*theta1d.^2.*cos(theta1)+l.*(theta1d+theta2d).^2.*cos(theta1+theta2)+ ...
  l.*sin(theta1).*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*(( ...
  1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+(-1/2).*l.^2.* ...
  m2.*theta1d.^2.*sin(theta2))+(1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3) ...
  .*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).* ...
  g.*l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+ ...
  l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.* ...
  sin(theta2)))+l.*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*(( ...
  1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+(-1/2).*l.^2.* ...
  m2.*theta1d.^2.*sin(theta2))+((1/3).*l.^2.*m1+(4/3).*l.^2.*m2+l.^2.*m2.* ...
  cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+theta2) ...
  +(-1/2).*l.^2.*m2.*theta1d.^2.*sin(theta2))+(1/3).*l.^2.*m2.*((1/9).* ...
  l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^( ...
  -1).*(1+(-1).*g.*l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.*m2.* ...
  cos(theta1+theta2)+l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).*l.^2.* ...
  m2.*theta2d.^2.*sin(theta2))+((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos( ...
  theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1).*(1+(-1).*g.*l.*((1/2).*m1+m2).*cos(theta1)+( ...
  -1/2).*g.*l.*m2.*cos(theta1+theta2)+l.^2.*m2.*theta1d.*theta2d.*sin( ...
  theta2)+(1/2).*l.^2.*m2.*theta2d.^2.*sin(theta2))).*sin(theta1+theta2)) ...
  .*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin( ...
  theta1)+l.*sin(theta1+theta2)).^2).^(-1/2)+(-1).*((-1).*xc+l.*cos( ...
  theta1)+l.*cos(theta1+theta2)).*(yrd+(-1).*l.*theta1d.*cos(theta1)+(-1) ...
  .*l.*(theta1d+theta2d).*cos(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+ ...
  l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2) ...
  ).^2).^(-3/2).*(2.*(l.*theta1d.*cos(theta1)+l.*(theta1d+theta2d).*cos( ...
  theta1+theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2))+2.*(( ...
  -1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*((-1).*l.*theta1d.*sin( ...
  theta1)+(-1).*l.*(theta1d+theta2d).*sin(theta1+theta2)))+(xr+(-1).*l.* ...
  cos(theta1)+(-1).*l.*cos(theta1+theta2)).*(l.*theta1d.*cos(theta1)+l.*( ...
  theta1d+theta2d).*cos(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos( ...
  theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2) ...
  .^(-3/2).*(2.*(l.*theta1d.*cos(theta1)+l.*(theta1d+theta2d).*cos(theta1+ ...
  theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2))+2.*((-1).*xc+ ...
  l.*cos(theta1)+l.*cos(theta1+theta2)).*((-1).*l.*theta1d.*sin(theta1)+( ...
  -1).*l.*(theta1d+theta2d).*sin(theta1+theta2)))+(-1).*(yr+(-1).*l.*sin( ...
  theta1)+(-1).*l.*sin(theta1+theta2)).*((-1).*l.*theta1d.*sin(theta1)+( ...
  -1).*l.*(theta1d+theta2d).*sin(theta1+theta2)).*(((-1).*xc+l.*cos( ...
  theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin( ...
  theta1+theta2)).^2).^(-3/2).*(2.*(l.*theta1d.*cos(theta1)+l.*(theta1d+ ...
  theta2d).*cos(theta1+theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin(theta1+ ...
  theta2))+2.*((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*((-1).*l.* ...
  theta1d.*sin(theta1)+(-1).*l.*(theta1d+theta2d).*sin(theta1+theta2)))+(( ...
  -1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).*(xrd+l.*theta1d.*sin( ...
  theta1)+l.*(theta1d+theta2d).*sin(theta1+theta2)).*(((-1).*xc+l.*cos( ...
  theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin( ...
  theta1+theta2)).^2).^(-3/2).*(2.*(l.*theta1d.*cos(theta1)+l.*(theta1d+ ...
  theta2d).*cos(theta1+theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin(theta1+ ...
  theta2))+2.*((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*((-1).*l.* ...
  theta1d.*sin(theta1)+(-1).*l.*(theta1d+theta2d).*sin(theta1+theta2)))+( ...
  3/4).*((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*(yr+(-1).*l.*sin( ...
  theta1)+(-1).*l.*sin(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos( ...
  theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2) ...
  .^(-5/2).*(2.*(l.*theta1d.*cos(theta1)+l.*(theta1d+theta2d).*cos(theta1+ ...
  theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2))+2.*((-1).*xc+ ...
  l.*cos(theta1)+l.*cos(theta1+theta2)).*((-1).*l.*theta1d.*sin(theta1)+( ...
  -1).*l.*(theta1d+theta2d).*sin(theta1+theta2))).^2+(-3/4).*(xr+(-1).*l.* ...
  cos(theta1)+(-1).*l.*cos(theta1+theta2)).*((-1).*yc+l.*sin(theta1)+l.* ...
  sin(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)) ...
  .^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2).^(-5/2).*(2.*( ...
  l.*theta1d.*cos(theta1)+l.*(theta1d+theta2d).*cos(theta1+theta2)).*((-1) ...
  .*yc+l.*sin(theta1)+l.*sin(theta1+theta2))+2.*((-1).*xc+l.*cos(theta1)+ ...
  l.*cos(theta1+theta2)).*((-1).*l.*theta1d.*sin(theta1)+(-1).*l.*( ...
  theta1d+theta2d).*sin(theta1+theta2))).^2+(-1/2).*((-1).*xc+l.*cos( ...
  theta1)+l.*cos(theta1+theta2)).*(yr+(-1).*l.*sin(theta1)+(-1).*l.*sin( ...
  theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+(( ...
  -1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2).^(-3/2).*(2.*(l.* ...
  theta1d.*cos(theta1)+l.*(theta1d+theta2d).*cos(theta1+theta2)).^2+2.*(( ...
  -1).*l.*theta1d.*sin(theta1)+(-1).*l.*(theta1d+theta2d).*sin(theta1+ ...
  theta2)).^2+2.*((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).*((-1).* ...
  l.*theta1d.^2.*sin(theta1)+l.*cos(theta1).*(((-1/3).*l.^2.*m2+(-1/2).* ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+ ...
  theta2)+(-1/2).*l.^2.*m2.*theta1d.^2.*sin(theta2))+(1/3).*l.^2.*m2.*(( ...
  1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1).*(1+(-1).*g.*l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.* ...
  m2.*cos(theta1+theta2)+l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).* ...
  l.^2.*m2.*theta2d.^2.*sin(theta2)))+l.*cos(theta1+theta2).*(((-1/3).* ...
  l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1/2).* ...
  g.*l.*m2.*cos(theta1+theta2)+(-1/2).*l.^2.*m2.*theta1d.^2.*sin(theta2))+ ...
  ((1/3).*l.^2.*m1+(4/3).*l.^2.*m2+l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.* ...
  m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*( ...
  1+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+(-1/2).*l.^2.*m2.*theta1d.^2.* ...
  sin(theta2))+(1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+( ...
  -1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.*l.*((1/2).*m1+ ...
  m2).*cos(theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+l.^2.*m2.* ...
  theta1d.*theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.*sin(theta2))+ ...
  ((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+( ...
  1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1) ...
  .*g.*l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2) ...
  +l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.* ...
  sin(theta2)))+(-1).*l.*(theta1d+theta2d).^2.*sin(theta1+theta2))+2.*(( ...
  -1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*((-1).*l.*theta1d.^2.* ...
  cos(theta1)+(-1).*l.*(theta1d+theta2d).^2.*cos(theta1+theta2)+(-1).*l.* ...
  sin(theta1).*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).* ...
  l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^( ...
  -1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+(-1/2).*l.^2.*m2.* ...
  theta1d.^2.*sin(theta2))+(1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.* ...
  l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+ ...
  l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.* ...
  sin(theta2)))+(-1).*l.*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)) ...
  .*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos( ...
  theta2).^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+(-1/2).* ...
  l.^2.*m2.*theta1d.^2.*sin(theta2))+((1/3).*l.^2.*m1+(4/3).*l.^2.*m2+ ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+ ...
  theta2)+(-1/2).*l.^2.*m2.*theta1d.^2.*sin(theta2))+(1/3).*l.^2.*m2.*(( ...
  1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1).*(1+(-1).*g.*l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.* ...
  m2.*cos(theta1+theta2)+l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).* ...
  l.^2.*m2.*theta2d.^2.*sin(theta2))+((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.* ...
  cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.*l.*((1/2).*m1+m2).*cos( ...
  theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+l.^2.*m2.*theta1d.* ...
  theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.*sin(theta2))).*sin( ...
  theta1+theta2)))+(1/2).*(xr+(-1).*l.*cos(theta1)+(-1).*l.*cos(theta1+ ...
  theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).*(((-1).*xc+ ...
  l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.* ...
  sin(theta1+theta2)).^2).^(-3/2).*(2.*(l.*theta1d.*cos(theta1)+l.*( ...
  theta1d+theta2d).*cos(theta1+theta2)).^2+2.*((-1).*l.*theta1d.*sin( ...
  theta1)+(-1).*l.*(theta1d+theta2d).*sin(theta1+theta2)).^2+2.*((-1).*yc+ ...
  l.*sin(theta1)+l.*sin(theta1+theta2)).*((-1).*l.*theta1d.^2.*sin(theta1) ...
  +l.*cos(theta1).*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*(( ...
  1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+(-1/2).*l.^2.* ...
  m2.*theta1d.^2.*sin(theta2))+(1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3) ...
  .*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).* ...
  g.*l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+ ...
  l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.* ...
  sin(theta2)))+l.*cos(theta1+theta2).*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.* ...
  m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+theta2) ...
  +(-1/2).*l.^2.*m2.*theta1d.^2.*sin(theta2))+((1/3).*l.^2.*m1+(4/3).* ...
  l.^2.*m2+l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.* ...
  m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1/2).*g.*l.* ...
  m2.*cos(theta1+theta2)+(-1/2).*l.^2.*m2.*theta1d.^2.*sin(theta2))+(1/3) ...
  .*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.*l.*((1/2).*m1+m2).*cos( ...
  theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+l.^2.*m2.*theta1d.* ...
  theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.*sin(theta2))+((-1/3).* ...
  l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.* ...
  l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+ ...
  l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.* ...
  sin(theta2)))+(-1).*l.*(theta1d+theta2d).^2.*sin(theta1+theta2))+2.*(( ...
  -1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*((-1).*l.*theta1d.^2.* ...
  cos(theta1)+(-1).*l.*(theta1d+theta2d).^2.*cos(theta1+theta2)+(-1).*l.* ...
  sin(theta1).*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).* ...
  l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^( ...
  -1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+(-1/2).*l.^2.*m2.* ...
  theta1d.^2.*sin(theta2))+(1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.* ...
  l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+ ...
  l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.* ...
  sin(theta2)))+(-1).*l.*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)) ...
  .*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos( ...
  theta2).^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+(-1/2).* ...
  l.^2.*m2.*theta1d.^2.*sin(theta2))+((1/3).*l.^2.*m1+(4/3).*l.^2.*m2+ ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+ ...
  theta2)+(-1/2).*l.^2.*m2.*theta1d.^2.*sin(theta2))+(1/3).*l.^2.*m2.*(( ...
  1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1).*(1+(-1).*g.*l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.* ...
  m2.*cos(theta1+theta2)+l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).* ...
  l.^2.*m2.*theta2d.^2.*sin(theta2))+((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.* ...
  cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.*l.*((1/2).*m1+m2).*cos( ...
  theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+l.^2.*m2.*theta1d.* ...
  theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.*sin(theta2))).*sin( ...
  theta1+theta2)))+(-1).*1.*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+ ...
  theta2)).*((-1/3).*l.^3.*m2.*cos(theta1).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+(-1).*l.*((1/3).* ...
  l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1)+((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).* ...
  ((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1)).*cos(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos( ...
  theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2) ...
  .^(-1/2)+((-1).*xr+l.*cos(theta1)+l.*cos(theta1+theta2)).*((1/3).*l.^3.* ...
  m2.*cos(theta1).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1)+l.*((1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+( ...
  1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((-1/3).* ...
  l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*cos(theta1+ ...
  theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+ ...
  l.*sin(theta1)+l.*sin(theta1+theta2)).^2).^(-1/2)+(yr+(-1).*l.*sin( ...
  theta1)+(-1).*l.*sin(theta1+theta2)).*((-1/3).*l.^3.*m2.*((1/9).*l.^4.* ...
  m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).* ...
  sin(theta1)+(-1).*l.*((1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((-1/3).*l.^2.* ...
  m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.* ...
  m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*sin(theta1+theta2)).* ...
  (((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin( ...
  theta1)+l.*sin(theta1+theta2)).^2).^(-1/2)+(yc+(-1).*l.*sin(theta1)+(-1) ...
  .*l.*sin(theta1+theta2)).*((1/3).*l.^3.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*sin(theta1)+l.*( ...
  (1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1)+((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos( ...
  theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1)).*sin(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+ ...
  l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2) ...
  ).^2).^(-1/2)+(1/2).*(xc+(-1).*l.*cos(theta1)+(-1).*l.*cos(theta1+ ...
  theta2)).*(yr+(-1).*l.*sin(theta1)+(-1).*l.*sin(theta1+theta2)).*(((-1) ...
  .*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+ ...
  l.*sin(theta1+theta2)).^2).^(-3/2).*(2.*((1/3).*l.^3.*m2.*cos(theta1).*( ...
  (1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1)+l.*((1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+ ...
  (-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((-1/3).*l.^2.*m2+(-1/2).* ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*cos(theta1+theta2)).*((-1).*yc+l.* ...
  sin(theta1)+l.*sin(theta1+theta2))+2.*((-1).*xc+l.*cos(theta1)+l.*cos( ...
  theta1+theta2)).*((-1/3).*l.^3.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.* ...
  m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*sin(theta1)+(-1).*l.*( ...
  (1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1)+((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos( ...
  theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1)).*sin(theta1+theta2)))+(1/2).*(xr+(-1).*l.*cos( ...
  theta1)+(-1).*l.*cos(theta1+theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin( ...
  theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+(( ...
  -1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2).^(-3/2).*(2.*((1/3).* ...
  l.^3.*m2.*cos(theta1).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1)+l.*((1/3).*l.^2.*m2.*((1/9).*l.^4.* ...
  m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+(( ...
  -1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+( ...
  1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*cos( ...
  theta1+theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2))+2.*(( ...
  -1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*((-1/3).*l.^3.*m2.*((1/9) ...
  .*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2) ...
  .^(-1).*sin(theta1)+(-1).*l.*((1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+( ...
  1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((-1/3).* ...
  l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*sin(theta1+ ...
  theta2))))+(-1).*1.*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)) ...
  .*((-1).*l.*cos(theta1).*((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2) ...
  ).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos( ...
  theta2).^2).^(-1)+(-1).*l.*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos( ...
  theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1)+((1/3).*l.^2.*m1+(4/3).*l.^2.*m2+l.^2.*m2.*cos( ...
  theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1)).*cos(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+ ...
  l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2) ...
  ).^2).^(-1/2)+((-1).*xr+l.*cos(theta1)+l.*cos(theta1+theta2)).*(l.*cos( ...
  theta1).*((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).* ...
  l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^( ...
  -1)+l.*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.* ...
  m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+(( ...
  1/3).*l.^2.*m1+(4/3).*l.^2.*m2+l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.* ...
  m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)).* ...
  cos(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)) ...
  .^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2).^(-1/2)+(yr+(-1) ...
  .*l.*sin(theta1)+(-1).*l.*sin(theta1+theta2)).*((-1).*l.*((-1/3).*l.^2.* ...
  m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.* ...
  m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*sin(theta1)+(-1).*l.*( ...
  ((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+( ...
  1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((1/3).* ...
  l.^2.*m1+(4/3).*l.^2.*m2+l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+( ...
  1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*sin( ...
  theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+(( ...
  -1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2).^(-1/2)+(yc+(-1).*l.* ...
  sin(theta1)+(-1).*l.*sin(theta1+theta2)).*(l.*((-1/3).*l.^2.*m2+(-1/2).* ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1).*sin(theta1)+l.*(((-1/3).*l.^2.*m2+( ...
  -1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+( ...
  -1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((1/3).*l.^2.*m1+(4/3).*l.^2.* ...
  m2+l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+( ...
  -1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*sin(theta1+theta2)).*(((-1) ...
  .*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+ ...
  l.*sin(theta1+theta2)).^2).^(-1/2)+(1/2).*(xc+(-1).*l.*cos(theta1)+(-1) ...
  .*l.*cos(theta1+theta2)).*(yr+(-1).*l.*sin(theta1)+(-1).*l.*sin(theta1+ ...
  theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+ ...
  l.*sin(theta1)+l.*sin(theta1+theta2)).^2).^(-3/2).*(2.*(l.*cos(theta1).* ...
  ((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+( ...
  1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+l.*(((-1/3) ...
  .*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((1/3).*l.^2.*m1+ ...
  (4/3).*l.^2.*m2+l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*cos(theta1+ ...
  theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2))+2.*((-1).*xc+ ...
  l.*cos(theta1)+l.*cos(theta1+theta2)).*((-1).*l.*((-1/3).*l.^2.*m2+( ...
  -1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+( ...
  -1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*sin(theta1)+(-1).*l.*(((-1/3) ...
  .*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((1/3).*l.^2.*m1+ ...
  (4/3).*l.^2.*m2+l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*sin(theta1+ ...
  theta2)))+(1/2).*(xr+(-1).*l.*cos(theta1)+(-1).*l.*cos(theta1+theta2)).* ...
  ((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).*(((-1).*xc+l.*cos( ...
  theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin( ...
  theta1+theta2)).^2).^(-3/2).*(2.*(l.*cos(theta1).*((-1/3).*l.^2.*m2+( ...
  -1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+( ...
  -1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+l.*(((-1/3).*l.^2.*m2+(-1/2).* ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((1/3).*l.^2.*m1+(4/3).*l.^2.*m2+ ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*cos(theta1+theta2)).*((-1).*yc+l.* ...
  sin(theta1)+l.*sin(theta1+theta2))+2.*((-1).*xc+l.*cos(theta1)+l.*cos( ...
  theta1+theta2)).*((-1).*l.*((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos( ...
  theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1).*sin(theta1)+(-1).*l.*(((-1/3).*l.^2.*m2+(-1/2).* ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((1/3).*l.^2.*m1+(4/3).*l.^2.*m2+ ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*sin(theta1+theta2))))];
rem(2,1)=[(-2).*(yrd+(-1).*l.*theta1d.*cos(theta1)+(-1).*l.*(theta1d+theta2d).* ...
  cos(theta1+theta2)).*(l.*theta1d.*cos(theta1)+l.*(theta1d+theta2d).*cos( ...
  theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+(( ...
  -1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2).^(-1/2)+(-2).*((-1).* ...
  l.*theta1d.*sin(theta1)+(-1).*l.*(theta1d+theta2d).*sin(theta1+theta2)) ...
  .*(xrd+l.*theta1d.*sin(theta1)+l.*(theta1d+theta2d).*sin(theta1+theta2)) ...
  .*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin( ...
  theta1)+l.*sin(theta1+theta2)).^2).^(-1/2)+(-1).*(yr+(-1).*l.*sin( ...
  theta1)+(-1).*l.*sin(theta1+theta2)).*((-1).*l.*theta1d.^2.*sin(theta1)+ ...
  l.*cos(theta1).*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*(( ...
  1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+(-1/2).*l.^2.* ...
  m2.*theta1d.^2.*sin(theta2))+(1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3) ...
  .*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).* ...
  g.*l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+ ...
  l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.* ...
  sin(theta2)))+l.*cos(theta1+theta2).*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.* ...
  m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+theta2) ...
  +(-1/2).*l.^2.*m2.*theta1d.^2.*sin(theta2))+((1/3).*l.^2.*m1+(4/3).* ...
  l.^2.*m2+l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.* ...
  m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1/2).*g.*l.* ...
  m2.*cos(theta1+theta2)+(-1/2).*l.^2.*m2.*theta1d.^2.*sin(theta2))+(1/3) ...
  .*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.*l.*((1/2).*m1+m2).*cos( ...
  theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+l.^2.*m2.*theta1d.* ...
  theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.*sin(theta2))+((-1/3).* ...
  l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.* ...
  l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+ ...
  l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.* ...
  sin(theta2)))+(-1).*l.*(theta1d+theta2d).^2.*sin(theta1+theta2)).*(((-1) ...
  .*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+ ...
  l.*sin(theta1+theta2)).^2).^(-1/2)+(-1).*((-1).*yc+l.*sin(theta1)+l.* ...
  sin(theta1+theta2)).*(yrdd+l.*theta1d.^2.*sin(theta1)+(-1).*l.*cos( ...
  theta1).*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).* ...
  l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^( ...
  -1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+(-1/2).*l.^2.*m2.* ...
  theta1d.^2.*sin(theta2))+(1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.* ...
  l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+ ...
  l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.* ...
  sin(theta2)))+(-1).*l.*cos(theta1+theta2).*(((-1/3).*l.^2.*m2+(-1/2).* ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+ ...
  theta2)+(-1/2).*l.^2.*m2.*theta1d.^2.*sin(theta2))+((1/3).*l.^2.*m1+( ...
  4/3).*l.^2.*m2+l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1/2).* ...
  g.*l.*m2.*cos(theta1+theta2)+(-1/2).*l.^2.*m2.*theta1d.^2.*sin(theta2))+ ...
  (1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.*l.*((1/2).*m1+m2).*cos( ...
  theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+l.^2.*m2.*theta1d.* ...
  theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.*sin(theta2))+((-1/3).* ...
  l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.* ...
  l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+ ...
  l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.* ...
  sin(theta2)))+l.*(theta1d+theta2d).^2.*sin(theta1+theta2)).*(((-1).*xc+ ...
  l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.* ...
  sin(theta1+theta2)).^2).^(-1/2)+(-1).*(xr+(-1).*l.*cos(theta1)+(-1).*l.* ...
  cos(theta1+theta2)).*((-1).*l.*theta1d.^2.*cos(theta1)+(-1).*l.*( ...
  theta1d+theta2d).^2.*cos(theta1+theta2)+(-1).*l.*sin(theta1).*(((-1/3).* ...
  l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1/2).* ...
  g.*l.*m2.*cos(theta1+theta2)+(-1/2).*l.^2.*m2.*theta1d.^2.*sin(theta2))+ ...
  (1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.*l.*((1/2).*m1+m2).*cos( ...
  theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+l.^2.*m2.*theta1d.* ...
  theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.*sin(theta2)))+(-1).* ...
  l.*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.* ...
  m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+ ...
  (-1/2).*g.*l.*m2.*cos(theta1+theta2)+(-1/2).*l.^2.*m2.*theta1d.^2.*sin( ...
  theta2))+((1/3).*l.^2.*m1+(4/3).*l.^2.*m2+l.^2.*m2.*cos(theta2)).*((1/9) ...
  .*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2) ...
  .^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+(-1/2).*l.^2.*m2.* ...
  theta1d.^2.*sin(theta2))+(1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.* ...
  l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+ ...
  l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.* ...
  sin(theta2))+((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).* ...
  l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^( ...
  -1).*(1+(-1).*g.*l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.*m2.* ...
  cos(theta1+theta2)+l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).*l.^2.* ...
  m2.*theta2d.^2.*sin(theta2))).*sin(theta1+theta2)).*(((-1).*xc+l.*cos( ...
  theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin( ...
  theta1+theta2)).^2).^(-1/2)+(-1).*((-1).*xc+l.*cos(theta1)+l.*cos( ...
  theta1+theta2)).*(xrdd+l.*theta1d.^2.*cos(theta1)+l.*(theta1d+theta2d) ...
  .^2.*cos(theta1+theta2)+l.*sin(theta1).*(((-1/3).*l.^2.*m2+(-1/2).* ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+ ...
  theta2)+(-1/2).*l.^2.*m2.*theta1d.^2.*sin(theta2))+(1/3).*l.^2.*m2.*(( ...
  1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1).*(1+(-1).*g.*l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.* ...
  m2.*cos(theta1+theta2)+l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).* ...
  l.^2.*m2.*theta2d.^2.*sin(theta2)))+l.*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.* ...
  m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+theta2) ...
  +(-1/2).*l.^2.*m2.*theta1d.^2.*sin(theta2))+((1/3).*l.^2.*m1+(4/3).* ...
  l.^2.*m2+l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.* ...
  m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1/2).*g.*l.* ...
  m2.*cos(theta1+theta2)+(-1/2).*l.^2.*m2.*theta1d.^2.*sin(theta2))+(1/3) ...
  .*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.*l.*((1/2).*m1+m2).*cos( ...
  theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+l.^2.*m2.*theta1d.* ...
  theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.*sin(theta2))+((-1/3).* ...
  l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.* ...
  l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+ ...
  l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.* ...
  sin(theta2))).*sin(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos( ...
  theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2) ...
  .^(-1/2)+(l.*theta1d.*cos(theta1)+l.*(theta1d+theta2d).*cos(theta1+ ...
  theta2)).*(yr+(-1).*l.*sin(theta1)+(-1).*l.*sin(theta1+theta2)).*(((-1) ...
  .*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+ ...
  l.*sin(theta1+theta2)).^2).^(-3/2).*(2.*(l.*theta1d.*cos(theta1)+l.*( ...
  theta1d+theta2d).*cos(theta1+theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin( ...
  theta1+theta2))+2.*((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*(( ...
  -1).*l.*theta1d.*sin(theta1)+(-1).*l.*(theta1d+theta2d).*sin(theta1+ ...
  theta2)))+(yrd+(-1).*l.*theta1d.*cos(theta1)+(-1).*l.*(theta1d+theta2d) ...
  .*cos(theta1+theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).* ...
  (((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin( ...
  theta1)+l.*sin(theta1+theta2)).^2).^(-3/2).*(2.*(l.*theta1d.*cos(theta1) ...
  +l.*(theta1d+theta2d).*cos(theta1+theta2)).*((-1).*yc+l.*sin(theta1)+l.* ...
  sin(theta1+theta2))+2.*((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).* ...
  ((-1).*l.*theta1d.*sin(theta1)+(-1).*l.*(theta1d+theta2d).*sin(theta1+ ...
  theta2)))+(xr+(-1).*l.*cos(theta1)+(-1).*l.*cos(theta1+theta2)).*((-1).* ...
  l.*theta1d.*sin(theta1)+(-1).*l.*(theta1d+theta2d).*sin(theta1+theta2)) ...
  .*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin( ...
  theta1)+l.*sin(theta1+theta2)).^2).^(-3/2).*(2.*(l.*theta1d.*cos(theta1) ...
  +l.*(theta1d+theta2d).*cos(theta1+theta2)).*((-1).*yc+l.*sin(theta1)+l.* ...
  sin(theta1+theta2))+2.*((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).* ...
  ((-1).*l.*theta1d.*sin(theta1)+(-1).*l.*(theta1d+theta2d).*sin(theta1+ ...
  theta2)))+((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*(xrd+l.* ...
  theta1d.*sin(theta1)+l.*(theta1d+theta2d).*sin(theta1+theta2)).*(((-1).* ...
  xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.* ...
  sin(theta1+theta2)).^2).^(-3/2).*(2.*(l.*theta1d.*cos(theta1)+l.*( ...
  theta1d+theta2d).*cos(theta1+theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin( ...
  theta1+theta2))+2.*((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*(( ...
  -1).*l.*theta1d.*sin(theta1)+(-1).*l.*(theta1d+theta2d).*sin(theta1+ ...
  theta2)))+(-3/4).*(xr+(-1).*l.*cos(theta1)+(-1).*l.*cos(theta1+theta2)) ...
  .*((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*(((-1).*xc+l.*cos( ...
  theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin( ...
  theta1+theta2)).^2).^(-5/2).*(2.*(l.*theta1d.*cos(theta1)+l.*(theta1d+ ...
  theta2d).*cos(theta1+theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin(theta1+ ...
  theta2))+2.*((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*((-1).*l.* ...
  theta1d.*sin(theta1)+(-1).*l.*(theta1d+theta2d).*sin(theta1+theta2))) ...
  .^2+(-3/4).*(yr+(-1).*l.*sin(theta1)+(-1).*l.*sin(theta1+theta2)).*((-1) ...
  .*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+ ...
  l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2) ...
  ).^2).^(-5/2).*(2.*(l.*theta1d.*cos(theta1)+l.*(theta1d+theta2d).*cos( ...
  theta1+theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2))+2.*(( ...
  -1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*((-1).*l.*theta1d.*sin( ...
  theta1)+(-1).*l.*(theta1d+theta2d).*sin(theta1+theta2))).^2+(1/2).*(xr+( ...
  -1).*l.*cos(theta1)+(-1).*l.*cos(theta1+theta2)).*((-1).*xc+l.*cos( ...
  theta1)+l.*cos(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+ ...
  theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2).^(-3/2) ...
  .*(2.*(l.*theta1d.*cos(theta1)+l.*(theta1d+theta2d).*cos(theta1+theta2)) ...
  .^2+2.*((-1).*l.*theta1d.*sin(theta1)+(-1).*l.*(theta1d+theta2d).*sin( ...
  theta1+theta2)).^2+2.*((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).*( ...
  (-1).*l.*theta1d.^2.*sin(theta1)+l.*cos(theta1).*(((-1/3).*l.^2.*m2+( ...
  -1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+( ...
  -1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos( ...
  theta1+theta2)+(-1/2).*l.^2.*m2.*theta1d.^2.*sin(theta2))+(1/3).*l.^2.* ...
  m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos( ...
  theta2).^2).^(-1).*(1+(-1).*g.*l.*((1/2).*m1+m2).*cos(theta1)+(-1/2) ...
  .*g.*l.*m2.*cos(theta1+theta2)+l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+( ...
  1/2).*l.^2.*m2.*theta2d.^2.*sin(theta2)))+l.*cos(theta1+theta2).*((( ...
  -1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+( ...
  1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+( ...
  -1/2).*g.*l.*m2.*cos(theta1+theta2)+(-1/2).*l.^2.*m2.*theta1d.^2.*sin( ...
  theta2))+((1/3).*l.^2.*m1+(4/3).*l.^2.*m2+l.^2.*m2.*cos(theta2)).*((1/9) ...
  .*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2) ...
  .^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+(-1/2).*l.^2.*m2.* ...
  theta1d.^2.*sin(theta2))+(1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.* ...
  l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+ ...
  l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.* ...
  sin(theta2))+((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).* ...
  l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^( ...
  -1).*(1+(-1).*g.*l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.*m2.* ...
  cos(theta1+theta2)+l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).*l.^2.* ...
  m2.*theta2d.^2.*sin(theta2)))+(-1).*l.*(theta1d+theta2d).^2.*sin(theta1+ ...
  theta2))+2.*((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*((-1).*l.* ...
  theta1d.^2.*cos(theta1)+(-1).*l.*(theta1d+theta2d).^2.*cos(theta1+ ...
  theta2)+(-1).*l.*sin(theta1).*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos( ...
  theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+(-1/2) ...
  .*l.^2.*m2.*theta1d.^2.*sin(theta2))+(1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.* ...
  m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+ ...
  (-1).*g.*l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.*m2.*cos(theta1+ ...
  theta2)+l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).*l.^2.*m2.* ...
  theta2d.^2.*sin(theta2)))+(-1).*l.*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.* ...
  cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+theta2) ...
  +(-1/2).*l.^2.*m2.*theta1d.^2.*sin(theta2))+((1/3).*l.^2.*m1+(4/3).* ...
  l.^2.*m2+l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.* ...
  m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1/2).*g.*l.* ...
  m2.*cos(theta1+theta2)+(-1/2).*l.^2.*m2.*theta1d.^2.*sin(theta2))+(1/3) ...
  .*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.*l.*((1/2).*m1+m2).*cos( ...
  theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+l.^2.*m2.*theta1d.* ...
  theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.*sin(theta2))+((-1/3).* ...
  l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.* ...
  l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+ ...
  l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.* ...
  sin(theta2))).*sin(theta1+theta2)))+(1/2).*(yr+(-1).*l.*sin(theta1)+(-1) ...
  .*l.*sin(theta1+theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2) ...
  ).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin( ...
  theta1)+l.*sin(theta1+theta2)).^2).^(-3/2).*(2.*(l.*theta1d.*cos(theta1) ...
  +l.*(theta1d+theta2d).*cos(theta1+theta2)).^2+2.*((-1).*l.*theta1d.*sin( ...
  theta1)+(-1).*l.*(theta1d+theta2d).*sin(theta1+theta2)).^2+2.*((-1).*yc+ ...
  l.*sin(theta1)+l.*sin(theta1+theta2)).*((-1).*l.*theta1d.^2.*sin(theta1) ...
  +l.*cos(theta1).*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*(( ...
  1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+(-1/2).*l.^2.* ...
  m2.*theta1d.^2.*sin(theta2))+(1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3) ...
  .*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).* ...
  g.*l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+ ...
  l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.* ...
  sin(theta2)))+l.*cos(theta1+theta2).*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.* ...
  m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+theta2) ...
  +(-1/2).*l.^2.*m2.*theta1d.^2.*sin(theta2))+((1/3).*l.^2.*m1+(4/3).* ...
  l.^2.*m2+l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.* ...
  m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1/2).*g.*l.* ...
  m2.*cos(theta1+theta2)+(-1/2).*l.^2.*m2.*theta1d.^2.*sin(theta2))+(1/3) ...
  .*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.*l.*((1/2).*m1+m2).*cos( ...
  theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+l.^2.*m2.*theta1d.* ...
  theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.*sin(theta2))+((-1/3).* ...
  l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.* ...
  l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+ ...
  l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.* ...
  sin(theta2)))+(-1).*l.*(theta1d+theta2d).^2.*sin(theta1+theta2))+2.*(( ...
  -1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*((-1).*l.*theta1d.^2.* ...
  cos(theta1)+(-1).*l.*(theta1d+theta2d).^2.*cos(theta1+theta2)+(-1).*l.* ...
  sin(theta1).*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).* ...
  l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^( ...
  -1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+(-1/2).*l.^2.*m2.* ...
  theta1d.^2.*sin(theta2))+(1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.* ...
  l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+ ...
  l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.* ...
  sin(theta2)))+(-1).*l.*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)) ...
  .*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos( ...
  theta2).^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+(-1/2).* ...
  l.^2.*m2.*theta1d.^2.*sin(theta2))+((1/3).*l.^2.*m1+(4/3).*l.^2.*m2+ ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1).*(1+(-1/2).*g.*l.*m2.*cos(theta1+ ...
  theta2)+(-1/2).*l.^2.*m2.*theta1d.^2.*sin(theta2))+(1/3).*l.^2.*m2.*(( ...
  1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1).*(1+(-1).*g.*l.*((1/2).*m1+m2).*cos(theta1)+(-1/2).*g.*l.* ...
  m2.*cos(theta1+theta2)+l.^2.*m2.*theta1d.*theta2d.*sin(theta2)+(1/2).* ...
  l.^2.*m2.*theta2d.^2.*sin(theta2))+((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.* ...
  cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1).*(1+(-1).*g.*l.*((1/2).*m1+m2).*cos( ...
  theta1)+(-1/2).*g.*l.*m2.*cos(theta1+theta2)+l.^2.*m2.*theta1d.* ...
  theta2d.*sin(theta2)+(1/2).*l.^2.*m2.*theta2d.^2.*sin(theta2))).*sin( ...
  theta1+theta2)))+(-1).*1.*(((-1/3).*l.^3.*m2.*cos(theta1).*((1/9).* ...
  l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^( ...
  -1)+(-1).*l.*((1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+( ...
  -1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((-1/3).*l.^2.*m2+(-1/2).* ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*cos(theta1+theta2)).*(yc+(-1).*l.* ...
  sin(theta1)+(-1).*l.*sin(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.* ...
  cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)) ...
  .^2).^(-1/2)+((1/3).*l.^3.*m2.*cos(theta1).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+l.*((1/3).*l.^2.* ...
  m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos( ...
  theta2).^2).^(-1)+((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*(( ...
  1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1)).*cos(theta1+theta2)).*((-1).*yr+l.*sin(theta1)+l.*sin( ...
  theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+(( ...
  -1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2).^(-1/2)+((-1).*xr+l.* ...
  cos(theta1)+l.*cos(theta1+theta2)).*((-1/3).*l.^3.*m2.*((1/9).*l.^4.* ...
  m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).* ...
  sin(theta1)+(-1).*l.*((1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((-1/3).*l.^2.* ...
  m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.* ...
  m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*sin(theta1+theta2)).* ...
  (((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin( ...
  theta1)+l.*sin(theta1+theta2)).^2).^(-1/2)+(xc+(-1).*l.*cos(theta1)+(-1) ...
  .*l.*cos(theta1+theta2)).*((1/3).*l.^3.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*sin(theta1)+l.*( ...
  (1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1)+((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos( ...
  theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1)).*sin(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+ ...
  l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2) ...
  ).^2).^(-1/2)+(1/2).*(xr+(-1).*l.*cos(theta1)+(-1).*l.*cos(theta1+ ...
  theta2)).*((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*(((-1).*xc+ ...
  l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.* ...
  sin(theta1+theta2)).^2).^(-3/2).*(2.*((1/3).*l.^3.*m2.*cos(theta1).*(( ...
  1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2) ...
  .^2).^(-1)+l.*((1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+ ...
  (-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((-1/3).*l.^2.*m2+(-1/2).* ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*cos(theta1+theta2)).*((-1).*yc+l.* ...
  sin(theta1)+l.*sin(theta1+theta2))+2.*((-1).*xc+l.*cos(theta1)+l.*cos( ...
  theta1+theta2)).*((-1/3).*l.^3.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.* ...
  m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*sin(theta1)+(-1).*l.*( ...
  (1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.* ...
  m2.^2.*cos(theta2).^2).^(-1)+((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos( ...
  theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1)).*sin(theta1+theta2)))+(1/2).*(yr+(-1).*l.*sin( ...
  theta1)+(-1).*l.*sin(theta1+theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin( ...
  theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+(( ...
  -1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2).^(-3/2).*(2.*((1/3).* ...
  l.^3.*m2.*cos(theta1).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1)+l.*((1/3).*l.^2.*m2.*((1/9).*l.^4.* ...
  m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+(( ...
  -1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+( ...
  1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*cos( ...
  theta1+theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2))+2.*(( ...
  -1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).*((-1/3).*l.^3.*m2.*((1/9) ...
  .*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2) ...
  .^(-1).*sin(theta1)+(-1).*l.*((1/3).*l.^2.*m2.*((1/9).*l.^4.*m1.*m2+( ...
  1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((-1/3).* ...
  l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*sin(theta1+ ...
  theta2))))+(-1).*1.*(((-1).*l.*cos(theta1).*((-1/3).*l.^2.*m2+(-1/2) ...
  .*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4) ...
  .*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+(-1).*l.*(((-1/3).*l.^2.*m2+(-1/2) ...
  .*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4) ...
  .*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((1/3).*l.^2.*m1+(4/3).*l.^2.*m2+ ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*cos(theta1+theta2)).*(yc+(-1).*l.* ...
  sin(theta1)+(-1).*l.*sin(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.* ...
  cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)) ...
  .^2).^(-1/2)+(l.*cos(theta1).*((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos( ...
  theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1)+l.*(((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos( ...
  theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1)+((1/3).*l.^2.*m1+(4/3).*l.^2.*m2+l.^2.*m2.*cos( ...
  theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1)).*cos(theta1+theta2)).*((-1).*yr+l.*sin(theta1)+ ...
  l.*sin(theta1+theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)) ...
  .^2+((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).^2).^(-1/2)+((-1).* ...
  xr+l.*cos(theta1)+l.*cos(theta1+theta2)).*((-1).*l.*((-1/3).*l.^2.*m2+( ...
  -1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+( ...
  -1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*sin(theta1)+(-1).*l.*(((-1/3) ...
  .*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((1/3).*l.^2.*m1+ ...
  (4/3).*l.^2.*m2+l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*sin(theta1+ ...
  theta2)).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+ ...
  l.*sin(theta1)+l.*sin(theta1+theta2)).^2).^(-1/2)+(xc+(-1).*l.*cos( ...
  theta1)+(-1).*l.*cos(theta1+theta2)).*(l.*((-1/3).*l.^2.*m2+(-1/2).* ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1).*sin(theta1)+l.*(((-1/3).*l.^2.*m2+( ...
  -1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+( ...
  -1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((1/3).*l.^2.*m1+(4/3).*l.^2.* ...
  m2+l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+( ...
  -1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*sin(theta1+theta2)).*(((-1) ...
  .*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+ ...
  l.*sin(theta1+theta2)).^2).^(-1/2)+(1/2).*(xr+(-1).*l.*cos(theta1)+(-1) ...
  .*l.*cos(theta1+theta2)).*((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2) ...
  ).*(((-1).*xc+l.*cos(theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin( ...
  theta1)+l.*sin(theta1+theta2)).^2).^(-3/2).*(2.*(l.*cos(theta1).*((-1/3) ...
  .*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+l.*(((-1/3).* ...
  l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((1/3).*l.^2.*m1+ ...
  (4/3).*l.^2.*m2+l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*cos(theta1+ ...
  theta2)).*((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2))+2.*((-1).*xc+ ...
  l.*cos(theta1)+l.*cos(theta1+theta2)).*((-1).*l.*((-1/3).*l.^2.*m2+( ...
  -1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+( ...
  -1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1).*sin(theta1)+(-1).*l.*(((-1/3) ...
  .*l.^2.*m2+(-1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((1/3).*l.^2.*m1+ ...
  (4/3).*l.^2.*m2+l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).* ...
  l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*sin(theta1+ ...
  theta2)))+(1/2).*(yr+(-1).*l.*sin(theta1)+(-1).*l.*sin(theta1+theta2)).* ...
  ((-1).*yc+l.*sin(theta1)+l.*sin(theta1+theta2)).*(((-1).*xc+l.*cos( ...
  theta1)+l.*cos(theta1+theta2)).^2+((-1).*yc+l.*sin(theta1)+l.*sin( ...
  theta1+theta2)).^2).^(-3/2).*(2.*(l.*cos(theta1).*((-1/3).*l.^2.*m2+( ...
  -1/2).*l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+( ...
  -1/4).*l.^4.*m2.^2.*cos(theta2).^2).^(-1)+l.*(((-1/3).*l.^2.*m2+(-1/2).* ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((1/3).*l.^2.*m1+(4/3).*l.^2.*m2+ ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*cos(theta1+theta2)).*((-1).*yc+l.* ...
  sin(theta1)+l.*sin(theta1+theta2))+2.*((-1).*xc+l.*cos(theta1)+l.*cos( ...
  theta1+theta2)).*((-1).*l.*((-1/3).*l.^2.*m2+(-1/2).*l.^2.*m2.*cos( ...
  theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).*l.^4.*m2.^2.* ...
  cos(theta2).^2).^(-1).*sin(theta1)+(-1).*l.*(((-1/3).*l.^2.*m2+(-1/2).* ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1)+((1/3).*l.^2.*m1+(4/3).*l.^2.*m2+ ...
  l.^2.*m2.*cos(theta2)).*((1/9).*l.^4.*m1.*m2+(1/3).*l.^4.*m2.^2+(-1/4).* ...
  l.^4.*m2.^2.*cos(theta2).^2).^(-1)).*sin(theta1+theta2))))];





Kp=[0.001 0; 0 0.001]*10^3;
Ks=[0.004 0;0 0.002]*1*10^4;

Tau = coeffmat\(-Ks*(Kp*epsilon+epsilond)-Kp*epsilond-rem)+Tauextra;
